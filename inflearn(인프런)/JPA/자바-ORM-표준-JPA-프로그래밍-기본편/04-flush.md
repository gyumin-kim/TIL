# flush(플러시)

**영속성 컨텍스트의 변경 내용을 데이터베이스에 반영**  

## 플러시 발생
- 트랜잭션이 발생하면 자동으로 flush 발생
- 변경 감지(dirty checking)
- 수정된 entity를 쓰기 지연 SQL 저장소에 등록
- 쓰기 지연 SQL 저장소의 쿼리를 데이터베이스에 전송
- 1차 캐시와는 상관 없으며, 쓰기 지연 SQL 저장소에 있던 쿼리를 데이터베이스에 전송하는 것이다.

## 영속성 컨텍스트를 flush하는 방법
- `em.flush()` (강제로 직접 호출)
  - 테스트나 다른 프레임워크와 JPA를 같이 사용할 때를 제외하면 거의 사용하지 않음.
- 트랜잭션 commit (flush 자동 호출)
  - JPA는 트랜잭션을 커밋할 때 flush를 자동으로 호출한다.
- JPQL 쿼리 실행 (flush 자동 호출)

## 플러시는!
- 영속성 컨텍스트에 보관된 entity를 지우는 것이 아니다.
- **영속성 컨텍스트의 변경 내용을 데이터베이스에 동기화**하는 것
- 트랜잭션이라는 작업 단위가 중요 → commit 직전에만 동기화하면 됨